CREATE TABLE public.tasks (id UUID PRIMARY KEY DEFAULT gen_random_uuid(), user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE, category_id UUID REFERENCES public.categories(id) ON DELETE SET NULL, title TEXT NOT NULL, description TEXT, due_date TIMESTAMPTZ, completed BOOLEAN DEFAULT FALSE, completed_at TIMESTAMPTZ, created_at TIMESTAMPTZ DEFAULT NOW(), updated_at TIMESTAMPTZ DEFAULT NOW()); ALTER TABLE public.tasks ENABLE ROW LEVEL SECURITY; CREATE POLICY "Users can view own tasks" ON public.tasks FOR SELECT USING (auth.uid() = user_id); CREATE POLICY "Users can insert own tasks" ON public.tasks FOR INSERT WITH CHECK (auth.uid() = user_id); CREATE POLICY "Users can update own tasks" ON public.tasks FOR UPDATE USING (auth.uid() = user_id); CREATE POLICY "Users can delete own tasks" ON public.tasks FOR DELETE USING (auth.uid() = user_id); CREATE INDEX idx_tasks_user_id ON public.tasks(user_id); CREATE INDEX idx_tasks_category_id ON public.tasks(category_id); CREATE INDEX idx_tasks_due_date ON public.tasks(due_date); CREATE INDEX idx_tasks_completed ON public.tasks(completed); CREATE INDEX idx_tasks_title ON public.tasks USING gin(to_tsvector('english', title)); CREATE INDEX idx_tasks_description ON public.tasks USING gin(to_tsvector('english', description));